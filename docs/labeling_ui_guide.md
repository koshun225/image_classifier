# Label-Studio風ラベリングUI - 使い方ガイド

最終更新: 2025-11-16

## 📋 概要

このドキュメントでは、Label-Studio風のWebラベリングUIの使い方を説明します。直感的な操作で、効率的に画像のラベリングができます。

## 🚀 起動方法

### 1. Django環境のセットアップ（初回のみ）

```bash
./scripts/setup_django.sh
```

### 2. Webサーバーの起動

```bash
cd src/web
python manage.py runserver
```

### 3. ブラウザでアクセス

```
http://127.0.0.1:8000/
```

## 🚀 初回セットアップ（Label-Studio風のワークフロー）

### ステップ1: テーマを作成

1. ダッシュボードで「➕ 新しいテーマを作成」をクリック
2. テーマ名を入力（例: 「動物分類」「MNIST」など）
3. 説明を入力（オプション）
4. 「➕ テーマを作成」をクリック

### ステップ2: ラベルを追加

テーマ作成後、自動的にラベル管理画面に移動します：

1. ラベル名を入力（例: 「犬」「猫」「鳥」）
2. 「➕ 追加」をクリック
3. 必要なラベルをすべて追加（最低2つ以上）

**ヒント**: ラベル番号（1-9）はキーボードショートカットで使用されます！

### ⭐️ 完全にAdmin不要！

すべての操作がWebUI上で完結します：
- ✅ テーマ作成・編集・削除
- ✅ ラベル追加・削除
- ✅ 画像アップロード（ドラッグ&ドロップ対応）
- ✅ ラベリング
- ✅ データ分割

**Admin画面は一切不要です！**

### ステップ3: 画像をアップロード

準備完了後、「📤 画像をアップロード」ボタンをクリック：

1. ラベルを選択（アップロードする画像のクラス）
2. 画像をドラッグ&ドロップまたはファイル選択
3. 複数の画像を一度にアップロード可能
4. プレビューで確認
5. 「⬆️ アップロード開始」をクリック

**対応形式**: JPG, PNG, BMP, GIF

### ステップ4: ラベリング開始

「🏷️ ラベリング開始」ボタンをクリック！

---

## 📊 ダッシュボード

### 機能

- **統計情報の表示**:
  - テーマ数
  - 総画像数

- **テーマ一覧**:
  - テーマごとのラベル数・画像数
  - テーマ管理画面へのアクセス
  - ラベリング画面へのクイックアクセス

### 使い方

1. ダッシュボードでテーマを選択
2. **「⚙️ 管理」**: テーマとラベルの編集
3. **「🏷️ ラベリング」**: ラベリング画面へ

---

## 🏷️ ラベリング画面

### 主要機能

#### 1. 画像グリッド表示

- **グリッド形式**: 一覧で複数の画像を同時に表示
- **サムネイル表示**: 各画像をプレビュー
- **ラベル状態表示**: 
  - 緑色: ラベル済み
  - グレー: 未ラベル
- **データ分割バッジ**: train/valid/test の表示

#### 2. ラベルパレット

- **ラベル選択**: クリックまたはキーボードでラベルを選択
- **数字キー対応**: 1〜9キーで素早く選択
- **視覚的フィードバック**: 選択中のラベルをハイライト表示

#### 3. フィルタリング

- **すべて**: 全画像を表示
- **未ラベル**: ラベル未設定の画像のみ
- **ラベル済み**: ラベル設定済みの画像のみ

#### 4. 統計情報リアルタイム表示

- 学習データ数
- 検証データ数
- テストデータ数
- 未分割データ数

---

## ⌨️ キーボードショートカット

Label-Studioのような効率的な操作が可能です。

| キー | 機能 |
|------|------|
| **1-9** | ラベル1〜9を選択 |
| **Space** | 次の未ラベル画像へ移動 |
| **Shift + Space** | 前のページへ戻る |
| **N** | 次のページへ |
| **P** | 前のページへ |
| **Escape** | モーダルを閉じる |

### 使用例

1. `1` キーを押してラベル1を選択
2. 画像をクリックして開く
3. モーダルで確認して選択
4. `Space` キーで次の画像へ

---

## 📸 ラベリングワークフロー

### ワークフロー1: クイックラベリング

```
1. ラベルパレットでラベルを選択（1-9キー）
2. 画像カードをクリック
3. モーダルで確認してラベルボタンをクリック
4. Spaceキーで次の画像へ
```

### ワークフロー2: バッチラベリング

```
1. フィルターで「未ラベル」を選択
2. ラベルパレットでラベルを選択
3. 画像を順番にラベリング
4. ページネーションで次のページへ
```

---

## 🔀 データ分割

### 自動データ分割機能

未ラベルの画像を train/valid/test に自動分割します。

#### 使い方

1. ラベリング画面で「🔀 データ分割実行」ボタンをクリック
2. 分割比率を設定:
   - 学習データ比率: 0.7（70%）
   - 検証データ比率: 0.15（15%）
   - テストデータ比率: 0.15（15%）
3. ランダムシード: 42（再現性のため）
4. 「実行」ボタンをクリック

#### 注意事項

- **既存データは保持**: 既にtrain/valid/testに分割されているデータは変更されません
- **新規データのみ分割**: 未分割（split未設定）の画像のみが分割対象です
- **再現性**: 同じシード値で同じ結果が得られます

---

## 🎨 UI機能

### モダンなデザイン

- **カードベースUI**: 見やすいカード形式
- **レスポンシブデザイン**: モバイル・タブレットにも対応
- **ホバーエフェクト**: マウスオーバーで視覚的フィードバック
- **スムーズなアニメーション**: 快適な操作感

### 画像プレビュー

- **サムネイル**: 一覧表示で素早く確認
- **モーダル表示**: クリックで拡大表示
- **オーバーレイ**: ホバーで編集ボタン表示

### 通知システム

- **成功通知**: ラベル更新時に緑色の通知
- **エラー通知**: 問題発生時に赤色の通知
- **自動消去**: 5秒後に自動的に消える

---

## 🔧 便利な機能

### 1. ページネーション

- 1ページに20枚表示
- 最初/前へ/次へ/最後のページへ移動可能
- 現在のページ番号を表示

### 2. リアルタイム統計更新

- 10秒ごとに統計情報を自動更新
- ラベリング進捗をリアルタイムで確認

### 3. フィルタリング

- 作業対象を絞り込んで効率化
- 未ラベル画像のみ表示してラベリング
- ラベル済み画像を確認

---

## 💡 ベストプラクティス

### 効率的なラベリング

1. **フィルター活用**: 「未ラベル」フィルターで作業対象を絞る
2. **キーボード操作**: 数字キーとSpaceキーで高速ラベリング
3. **バッチ処理**: 同じラベルの画像をまとめて処理
4. **定期的な分割実行**: 一定数ラベリングしたら分割を実行

### データ品質の確保

1. **ラベル確認**: ラベル済みフィルターで確認
2. **統計確認**: 各ラベルのデータ数をチェック
3. **バランス調整**: クラス間のデータ数を均等に

---

## 🐛 トラブルシューティング

### 画像が表示されない

**原因**: メディアファイルの設定が正しくない

**解決方法**:
```bash
# 開発サーバーを再起動
cd src/web
python manage.py runserver
```

### ラベル更新が反映されない

**原因**: キャッシュの問題

**解決方法**:
- ページをリロード（F5）
- ブラウザのキャッシュをクリア

### キーボードショートカットが効かない

**原因**: モーダルが開いている、または入力フォームにフォーカスがある

**解決方法**:
- Escapeキーでモーダルを閉じる
- 画像グリッド部分をクリックしてフォーカスを移す

---

## 📱 対応ブラウザ

- ✅ Chrome / Edge（推奨）
- ✅ Firefox
- ✅ Safari
- ⚠️ Internet Explorer（非推奨）

---

## 🎯 次のステップ

1. **ラベリング実施**: 画像にラベルを付ける
2. **データ分割実行**: train/valid/testに分割
3. **モデル学習**: PyTorchパイプラインで学習
   ```bash
   python scripts/train.py --theme-id 1
   ```

---

## 🔗 関連ドキュメント

- [Django セットアップガイド](django_setup.md)
- [要件定義書](requirements.md)
- [アーキテクチャ設計書](architecture.md)
- [進捗管理](progress.md)

---

## 📝 フィードバック

改善要望や不具合報告は、Issueまたはプルリクエストでお願いします。

---

## 🎉 まとめ

Label-Studio風のUIで、効率的に画像ラベリングができます！

### 主な特徴

- ✅ **直感的な操作**: クリックとキーボードで素早くラベリング
- ✅ **モダンなUI**: 美しく使いやすいデザイン
- ✅ **効率的なワークフロー**: キーボードショートカットで高速作業
- ✅ **リアルタイム更新**: 統計情報を常に表示
- ✅ **データ分割自動化**: ワンクリックで分割実行

楽しいラベリングを！🏷️✨

